[SERVICE]
    Flush        1
    Grace        1
    Log_Level    error
    Parsers_File ${FLB_ROOT}/conf/parsers.conf

[INPUT]
    name syslog
    host ${LISTENER_HOST}
    port ${LISTENER_PORT}
    mode tcp
    tls.verify no
    tls on
    tls.vhost ${LISTENER_VHOST}
    tls.debug 4
    tls.crt_file ${FLB_RUNTIME_SHELL_PATH}/tls/certificate.pem
    tls.key_file ${FLB_RUNTIME_SHELL_PATH}/tls/private_key.pem


[FILTER]
    Name                 expect
    Match                *
    Log_Level            debug
    # Rules
    key_exists           $message
    key_val_eq           $message Hello!
    action               exit

[OUTPUT]
    Name  exit
    Match *

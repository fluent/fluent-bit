# OpenTelemetry Demo Override Configuration for Direct Fluent Bit Integration
# This configures all services to send telemetry directly to Fluent Bit

version: '3.9'

services:
  # Disable the OTEL collector - we'll use Fluent Bit directly
  otel-collector:
    deploy:
      replicas: 0
    command: ["echo", "OTEL Collector disabled - using Fluent Bit directly"]

  # Override all services to send directly to Fluent Bit
  accounting:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  ad:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  cart:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  checkout:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  currency:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  email:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  fraud:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  frontend:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
      - PUBLIC_OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://localhost:24318/v1/traces
  
  payment:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  product-catalog:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  quote:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  recommendation:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
  
  shipping:
    environment:
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:24318
      - OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf

# Example Fluent Bit configuration for Parseable output plugin
#
# This configuration demonstrates all available features:
# - Reads from dummy input (generates test logs)
# - Sends to Parseable with compression, custom headers, and metrics

[SERVICE]
    Flush        5
    Daemon       Off
    Log_Level    info
    
    # Enable HTTP server for metrics
    HTTP_Server  On
    HTTP_Listen  0.0.0.0
    HTTP_Port    2020

[INPUT]
    Name   dummy
    Tag    test.logs
    Dummy  {"message": "test log from fluent-bit", "level": "info"}

[OUTPUT]
    Name          parseable
    Match         *
    
    # Parseable server connection
    Host          localhost
    Port          8000
    
    # Required: Stream name (sent as X-P-Stream header)
    stream        my-test-stream
    
    # Optional: Log source identifier (sent as X-P-Log-Source header)
    log_source    fluent-bit
    
    # Optional: URI path (default: /api/v1/ingest)
    uri           /api/v1/ingest
    
    # Optional: Authorization header
    # Format: "Basic <base64(username:password)>"
    # Example: auth_header Basic YWRtaW46YWRtaW4=
    # auth_header   Basic YWRtaW46YWRtaW4=
    
    # Optional: Enable gzip compression
    compress      gzip
    
    # Optional: Maximum batch size in bytes (default: 5MB)
    # This example sets it to 10MB
    batch_size    10485760
    
    # Optional: Retry limit (-1 = unlimited, 0 = no retries)
    # This example allows up to 3 retries
    retry_limit   3
    
    # Optional: Custom headers (can be specified multiple times)
    header        X-Environment development
    header        X-Region us-west-2
    header        X-Application fluent-bit-test
    
    # Optional: JSON date format
    # 0 = epoch (default)
    # 1 = iso8601
    # 2 = java_sql_timestamp
    json_date_format  1
    
    # Optional: Timestamp key name in JSON
    json_date_key     timestamp
    
    # Optional: Enable TLS
    # tls           On
    # tls.verify    Off

# Access metrics at: http://localhost:2020/api/v1/metrics/prometheus
